<div class="grid" *ngIf="loadingChart; else spinnerTemplate">
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3 text-xl">Total Reports</span>
                    <div class="text-900 font-medium text-xl">
                        {{ formatNumberWithDots(totalGeneral) }}
                    </div>
                </div>
                <div class="flex align-items-center justify-content-center bg-blue-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }">
                    <i class="pi pi-file text-blue-500 text-xl"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3 text-xl">Unrecognized Reports
                    </span>
                    <div class="text-900 font-medium text-xl">
                        {{
                        formatNumberWithDots(totalNull[0]?.total_null || 0)
                        }}
                    </div>
                </div>
                <div class="flex align-items-center justify-content-center bg-orange-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }">
                    <i class="pi pi-info-circle text-orange-500 text-xl"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3 text-xl">Valid Reports</span>
                    <div class="text-900 font-medium text-xl">
                        {{
                        formatNumberWithDots(
                        totalGeneralStatus[0]?.total_available || 0
                        )
                        }}
                    </div>
                </div>
                <div class="flex align-items-center justify-content-center bg-green-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }">
                    <i class="pi pi-check-circle text-green-500 text-xl"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 lg:col-6 xl:col-3">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3 text-xl">Invalid Reports</span>
                    <div class="text-900 font-medium text-xl">
                        {{
                        formatNumberWithDots(
                        totalGeneralStatus[0]?.total_unavailable || 0
                        )
                        }}
                    </div>
                </div>
                <div class="flex align-items-center justify-content-center bg-red-100 border-round"
                    [ngStyle]="{ width: '2.5rem', height: '2.5rem' }">
                    <i class="pi pi-times-circle text-red-500 text-xl"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 xl:col-6">
        <div class="card">
            <div class="flex justify-content-between align-items-center mb-5">
                <h5>Status Unit's</h5>
                <div>
                    <button pButton type="button" icon="pi pi-ellipsis-v"
                        class="p-button-rounded p-button-text p-button-plain" (click)="menu.toggle($event)"></button>
                    <p-menu #menu [popup]="true" [model]="items"></p-menu>
                </div>
            </div>
            <ul class="list-none p-0 m-0">
                <li class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">
                    <div>
                        <span class="text-900 font-medium mr-2 mb-1 md:mb-0">DMR</span>
                        <div class="mt-1 text-600">Scanning Report</div>
                    </div>
                    <div class="mt-2 md:mt-0 flex align-items-center">
                        <div class="surface-300 border-round overflow-hidden w-10rem lg:w-6rem"
                            [ngStyle]="{ height: '8px' }">
                            <div class="bg-green-500 h-full" [ngStyle]="{ width: '60%' }"></div>
                        </div>
                        <span class="text-green-500 ml-3 font-medium">%60</span>
                    </div>
                </li>
                <li class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">
                    <div>
                        <span class="text-900 font-medium mr-2 mb-1 md:mb-0">DLDS</span>
                        <div class="mt-1 text-600">Make Reports</div>
                    </div>
                    <div class="mt-2 md:mt-0 ml-0 md:ml-8 flex align-items-center">
                        <div class="surface-300 border-round overflow-hidden w-10rem lg:w-6rem"
                            [ngStyle]="{ height: '8px' }">
                            <div class="bg-cyan-500 h-full" [ngStyle]="{ width: '16%' }"></div>
                        </div>
                        <span class="text-cyan-500 ml-3 font-medium">%16</span>
                    </div>
                </li>
                <li class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">
                    <div>
                        <span class="text-900 font-medium mr-2 mb-1 md:mb-0">DPPK</span>
                        <div class="mt-1 text-600">Arrange Reports</div>
                    </div>
                    <div class="mt-2 md:mt-0 ml-0 md:ml-8 flex align-items-center">
                        <div class="surface-300 border-round overflow-hidden w-10rem lg:w-6rem"
                            [ngStyle]="{ height: '8px' }">
                            <div class="bg-pink-500 h-full" [ngStyle]="{ width: '67%' }"></div>
                        </div>
                        <span class="text-pink-500 ml-3 font-medium">%67</span>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <div class="col-12 xl:col-6">
        <div class="card">
            <h5>Note</h5>
            <p-panel header="Informations" [toggleable]="true" class="line-height-3 m-0 text-2xl">
                <div>
                    <Strong> Total Reports </Strong> : Jumlah semua data yang
                    terdapat di dalam swift.
                </div>
                <div>
                    <Strong>Unrecognized Reports </Strong> : Jumlah semua data
                    yang terdapat di dalam swift tetapi tidak memiliki
                    doc_posting_date.
                </div>
                <div>
                    <strong>Available Reports </strong> : Jumlah semua data yang
                    terdapat di dalam ARC SWIFT, memiliki lokasi doc_box dan
                    title serta tidak di dasari oleh tanggal.
                </div>
                <div>
                    <strong> Unavailable Reports </strong> : Jumlah semua data
                    yang terdapat di dalam ARC SWIFT tidak memiliki doc_box dan
                    title serta tidak di dasari oleh tanggal.
                </div>
            </p-panel>
        </div>
    </div>

    <div class="col-12 xl:col-12">
        <div class="card">
            <div class="text-3xl font-bold mb-4">
                <h5>Report Overview
                    <span class="ml-4">
                        <p-dropdown [options]="dataOperator" [(ngModel)]="selectedOperator2" optionLabel="operator"
                            (onChange)="onGlobalPlane(dt2, $event, 'total')" class="text-2xl" [filter]="true"
                            placeholder="Select Bank" [showClear]="true" (onClear)="clear(dt2, 'dt2')"></p-dropdown>
                    </span>
                </h5>
            </div>
            <h6>
                Total Data (Available & Unavailable) :
                {{ formatNumberWithDots(totalDocuments) }}
            </h6>
            <h6>
                Total Available : {{ formatNumberWithDots(totalAvailable) }}
            </h6>
            <h6>
                Total Unavailable : {{ formatNumberWithDots(totalUnavailable) }}
            </h6>
            <p-chart *ngIf="chartData && chartData.labels.length > 0" type="line" [data]="chartData"
                [options]="chartOptions"></p-chart>
            <div *ngIf="!chartData || chartData.labels.length === 0">
                <!-- Skeleton loading placeholders -->
                <div class="skeleton-line" style="height: 1rem; width: 80%"></div>
                <div class="skeleton-line" style="height: 1rem; width: 70%"></div>
                <div class="skeleton-line" style="height: 1rem; width: 60%"></div>
                <!-- Add more skeleton lines as needed -->
            </div>
        </div>
    </div>

    <div class="col-12">
        <div class="card">
            <div class="arc-report-container">
                <div>
                    <div class="text-3xl font-bold mb-4">
                        Laporan Neraca
                        <span class="ml-4">
                            <p-dropdown [options]="dataOperator" [(ngModel)]="selectedOperator2" optionLabel="operator"
                                (onChange)="onGlobalPlane(dt2, $event, 'total')" class="text-2xl" [filter]="true"
                                placeholder="Select Bank" [showClear]="true" (onClear)="clear(dt2, 'dt2')"></p-dropdown>
                        </span>
                    </div>

                    <p-table #dt2 [value]="reports2" dataKey="id" [rows]="10" [loading]="loading2" [rowHover]="true"
                        styleClass="p-datatable-gridlines" [globalFilterFields]="['ac_type', 'operator']"
                        responsiveLayout="scroll" [scrollable]="true" scrollHeight="600px" rowGroupMode="subheader"
                        groupRowsBy="operator">
                        <ng-template pTemplate="caption">
                            <div class="flex justify-content-between flex-column sm:flex-row">
                                <button pButton label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash"
                                    (click)="clear(dt2, 'dt2')"></button>
                                <span class="p-input-icon-left mb-2">
                                    <i class="pi pi-search"></i>
                                    <input pInputText type="text" #filter pTrim (keydown.enter)="
                                            onGlobalFilter(dt2, $event, 'dt2')
                                        " placeholder="Search Keyword" class="w-full" />
                                </span>
                                <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help"
                                    (click)="openExport('total')"></button>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <!-- Kolom LLP -->
                            <tr>
                                <th style="min-width: 8rem" pSortableColumn="llp_linked">
                                    <div class="flex justify-content-between align-items-center">
                                        Satuan Kerja
                                        <p-sortIcon field="llp_linked"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 8rem" pSortableColumn="llp_baseline">
                                    <div class="flex justify-content-between align-items-center">
                                        Nomor Tiket
                                        <p-sortIcon field="llp_baseline"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 5rem" pSortableColumn="llp_percentage">
                                    <div class="flex justify-content-between align-items-center">
                                        Tanggal Gangguan
                                        <p-sortIcon field="llp_percentage"></p-sortIcon>
                                    </div>
                                </th>

                                <th style="min-width: 8rem" pSortableColumn="tc_linked">
                                    <div class="flex justify-content-between align-items-center">
                                        Deskripsi Gangguan
                                        <p-sortIcon field="tc_linked"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 8rem" pSortableColumn="tc_baseline">
                                    <div class="flex justify-content-between align-items-center">
                                        Aplikasi Kritikal
                                        <p-sortIcon field="tc_baseline"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 5rem" pSortableColumn="tc_percentage">
                                    <div class="flex justify-content-between align-items-center">
                                        Tugas Kritikal
                                        <p-sortIcon field="tc_percentage"></p-sortIcon>
                                    </div>
                                </th>

                                <!-- Kolom NON TC -->
                                <th style="min-width: 8rem" pSortableColumn="non_tc_linked">
                                    <div class="flex justify-content-between align-items-center">
                                        Lama Gangguan
                                        <p-sortIcon field="non_tc_linked"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 8rem" pSortableColumn="non_tc_baseline">
                                    <div class="flex justify-content-between align-items-center">
                                        Dampak Gangguan
                                        <p-sortIcon field="non_tc_baseline"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 5rem" pSortableColumn="non_tc_percentage">
                                    <div class="flex justify-content-between align-items-center">
                                        Nominal
                                        <p-sortIcon field="non_tc_percentage"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 5rem" pSortableColumn="non_tc_percentage">
                                    <div class="flex justify-content-between align-items-center">
                                        Frekuensi
                                        <p-sortIcon field="non_tc_percentage"></p-sortIcon>
                                    </div>
                                </th>
                                <th style="min-width: 5rem" pSortableColumn="non_tc_percentage">
                                    <div class="flex justify-content-between align-items-center">
                                        Frekuensi
                                        <p-sortIcon field="non_tc_percentage"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Upaya
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Alternatif
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Waktu Pemulihan
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Prioritas
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Jenis
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                                <th rowspan="4" pSortableColumn="total_count">
                                    <div class="flex justify-content-between align-items-center">
                                        Masalah Umum
                                        <p-sortIcon field="total_count"></p-sortIcon>
                                    </div>
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="groupheader" let-report>
                            <tr pRowGroupHeader>
                                <td colspan="14">
                                    <span class="font-bold ml-2">{{
                                        report?.operator || "Others"
                                        }}</span>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-reports2>
                            <tr>
                                <td class="text-center">
                                    {{ reports2?.ac_type }}
                                </td>
                                <td class="text-center">
                                    {{ reports2?.llp_linked }}
                                </td>
                                <td class="text-center">
                                    {{ reports2?.llp_baseline }}
                                </td>
                                <td class="text-center">
                                    {{
                                    reports2?.llp_percentage || 0
                                    | number : "1.2-2"
                                    }}%
                                </td>
                                <td class="text-center">
                                    {{ reports2?.tc_linked }}
                                </td>
                                <td class="text-center">
                                    {{ reports2?.tc_baseline }}
                                </td>
                                <td class="text-center">
                                    {{
                                    reports2?.tc_percentage || 0
                                    | number : "1.2-2"
                                    }}%
                                </td>
                                <td class="text-center">
                                    {{ reports2?.non_tc_linked }}
                                </td>
                                <td class="text-center">
                                    {{ reports2?.non_tc_baseline }}
                                </td>
                                <td class="text-center">
                                    {{
                                    reports2?.non_tc_percentage || 0
                                    | number : "1.2-2"
                                    }}%
                                </td>
                                <td class="text-center">
                                    {{ reports2?.total_count }}
                                </td>
                                <td class="text-center">
                                    <button pButton pRipple icon="pi pi-trash" [disabled]="true"
                                        class="p-button-rounded p-button-danger" (click)="
                                            deleteProduct(reports2, 'total')
                                        "></button>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="8">No components found.</td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="loadingbody">
                            <tr>
                                <td colspan="8">
                                    Loading components data. Please wait.
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>
        <p-dialog [(visible)]="exportDialog2" [style]="{ width: '400px', height: '250px' }" header="Pilihan Export File"
            [modal]="true" styleClass="p-fluid">
            <div class="p-field">
                <label for="exportFormat" class="mb-2">Pilih Format Export:</label>
                <div class="mt-2">
                    <p-dropdown id="exportFormat" [(ngModel)]="selectedExportFormat" [options]="exportFormats"
                        class="mt-2"></p-dropdown>
                </div>
            </div>
            <div class="p-dialog-footer mt-4">
                <button pButton type="button" label="Export" (click)="exportData('total')"
                    class="p-button-success mr-2 text-align-center"></button>
                <button pButton type="button" label="Cancel" (click)="cancelExport()"
                    class="ml-2 p-button-danger"></button>
            </div>
        </p-dialog>
    </div>
</div>
<!-- Spinner template to show when loadingChart is not true -->
<ng-template #spinnerTemplate>
    <div class="flex justify-center items-center h-screen">
        <p-progressSpinner styleClass="w-4rem h-4rem" strokeWidth="8" fill="var(--surface-ground)"
            animationDuration=".8s"></p-progressSpinner>
    </div>
</ng-template>
<p-confirmDialog [style]="{ width: '450px' }" rejectButtonStyleClass="p-button-danger"
    acceptButtonStyleClass="p-button-success"></p-confirmDialog>