<div class="grid">
    <div class="col-12">
        <p-toast></p-toast>
        <p-toolbar styleClass="mb-4 gap-2">
            <ng-template pTemplate="left">
                <button
                    pButton
                    pRipple
                    icon="pi pi-plus"
                    class="p-button-success mr-2"
                    (click)="openNew()"
                ></button>
                <button
                    pButton
                    pRipple
                    icon="pi pi-trash"
                    class="p-button-danger"
                    [disabled]="!selectedProducts || !selectedProducts.length"
                ></button>
                <button
                    pButton
                    pRipple
                    label="Export"
                    icon="pi pi-upload"
                    class="p-button-help ml-8"
                    (click)="openExport()"
                ></button>
                <p-fileUpload
                    mode="basic"
                    accept="image/*"
                    [maxFileSize]="1000000"
                    label="Import"
                    chooseLabel="Import"
                    class="ml-4 inline-block"
                ></p-fileUpload>
            </ng-template>
        </p-toolbar>
        <div class="card">
            <h5>Docfile RMS Report</h5>
            <p-table
                #dt1
                [columns]="components1"
                [value]="components1"
                [lazy]="true"
                (onLazyLoad)="onLazyLoad($event)"
                [loading]="loading"
                [paginator]="!findSearch"
                [rows]="10"
                [totalRecords]="totalRecords"
                dataKey="id"
                [rowHover]="true"
                styleClass="p-datatable-gridlines"
                responsiveLayout="scroll"
            >
                <ng-template pTemplate="caption">
                    <div
                        class="flex justify-content-between flex-column sm:flex-row"
                    >
                        <button
                            pButton
                            label="Clear"
                            class="p-button-outlined mb-2"
                            icon="pi pi-filter-slash"
                            (click)="clear(dt1)"
                        ></button>
                        <span class="p-input-icon-left mb-2">
                            <span class="p-input-icon-left mr-4">
                                <i class="pi pi-search"></i>
                                <input
                                    label="inputSearch"
                                    type="text"
                                    pInputText
                                    [(ngModel)]="findSearch"
                                    (keydown.enter)="findData(findSearch)"
                                />
                            </span>
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width: 5rem">
                            <div
                                class="flex justify-content-between align-items-center"
                                pSortableColumn="equipment"
                            >
                                No
                                <p-sortIcon field="equipment"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Posting Date
                                <p-sortIcon
                                    field="material_number"
                                ></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Type
                                <p-sortIcon field="serial_number"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 12rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Location
                                <p-sortIcon
                                    field="material_description"
                                ></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 5rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Status
                                <p-sortIcon field="material_group"></p-sortIcon>
                            </div>
                        </th>

                        <th style="min-width: 5rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Created Date
                                <p-sortIcon field="aircraft_reg"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Created By
                                <p-sortIcon field="doc_no"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Last Update
                                <p-sortIcon field="doc_locations"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Last User
                                <p-sortIcon field="doc_locations"></p-sortIcon>
                            </div>
                        </th>

                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Category
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Aircrafte
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Work Packagee
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Reason
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Return Date
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Retention Schedule
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Last Received
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Last Rejected
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Filed
                                <p-sortIcon field="status"></p-sortIcon>
                            </div>
                        </th>
                        <th class="text-center" style="min-width: 10rem">
                            Actions
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-component>
                    <tr>
                        <td class="text-center">
                            {{ component?.doc_no }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_posting_date }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_type }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_location }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_status }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_createddate }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_createdby }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_lastupdate }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_lastuser }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_category }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_aircrafte }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_work_packagee }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_reason }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_returndate }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_retention_schedule }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_last_received }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_last_rejected }}
                        </td>
                        <td class="text-center">
                            {{ component?.doc_filed }}
                        </td>

                        <td class="text-center">
                            <button
                                pButton
                                pRipple
                                icon="pi pi-pencil"
                                class="p-button-rounded p-button-success mr-2"
                                (click)="editProduct(component)"
                            ></button>
                            <button
                                pButton
                                pRipple
                                icon="pi pi-trash"
                                class="p-button-rounded p-button-warning"
                                (click)="deleteProduct(component)"
                            ></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8">No component found.</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td colspan="8">
                            Loading components data. Please wait.
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        <p-toast></p-toast>
    </div>
</div>

<p-dialog
    [(visible)]="recordDialog"
    [style]="{ width: '850px' }"
    header="New Records"
    [modal]="true"
    styleClass="p-fluid"
    class="grid grid-cols-2 gap-4"
>
    <h5>Docfile RMS</h5>
    <div class="p-fluid p-formgrid grid">
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_no" class="text-xl">No</label>
            <input
                pInputText
                id="doc_no"
                type="text"
                [(ngModel)]="data.docfile.doc_no"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_type" class="text-xl">Type</label>
            <input
                pInputText
                id="doc_type"
                type="text"
                [(ngModel)]="data.docfile.doc_type"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_location" class="text-xl">Location</label>
            <input
                pInputText
                id="doc_location"
                type="text"
                [(ngModel)]="data.docfile.doc_location"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_status" class="text-xl">Status</label>
            <input
                pInputText
                id="doc_status"
                type="text"
                [(ngModel)]="data.docfile.doc_status"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_category" class="text-xl">Category</label>
            <input
                pInputText
                id="doc_category"
                type="text"
                [(ngModel)]="data.docfile.doc_category"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_aircrafte" class="text-xl">Aircrafte</label>
            <input
                pInputText
                id="doc_aircrafte"
                type="text"
                [(ngModel)]="data.docfile.doc_aircrafte"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_work_packagee" class="text-xl"
                >Work Package</label
            >
            <input
                pInputText
                id="doc_work_packagee"
                type="text"
                [(ngModel)]="data.docfile.doc_work_packagee"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_reason" class="text-xl">Reason</label>
            <input
                pInputText
                id="doc_reason"
                type="text"
                [(ngModel)]="data.docfile.doc_reason"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_returndate" class="text-xl">Return Date</label>
            <input
                pInputText
                id="doc_returndate"
                type="text"
                placeholder="Ex : 2023-06-22"
                [(ngModel)]="data.docfile.doc_returndate"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_retention_schedule" class="text-xl"
                >Retention Schedule</label
            >
            <input
                pInputText
                id="doc_retention_schedule"
                type="text"
                placeholder="Ex : 2023-06-22"
                [(ngModel)]="data.docfile.doc_retention_schedule"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_last_received" class="text-xl"
                >Last Received</label
            >
            <input
                pInputText
                id="doc_last_received"
                type="text"
                placeholder="Ex : 2023-06-22"
                [(ngModel)]="data.docfile.doc_last_received"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_last_rejected" class="text-xl"
                >Last Rejected</label
            >
            <input
                pInputText
                id="doc_last_rejected"
                type="text"
                placeholder="Ex : 2023-06-22"
                [(ngModel)]="data.docfile.doc_last_rejected"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_filed" class="text-xl">Document Filled</label>
            <input
                pInputText
                id="doc_filed"
                type="text"
                [(ngModel)]="data.docfile.doc_filed"
            />
        </div>
    </div>

    <div class="p-dialog-footer">
        <button
            type="button"
            pButton
            label="Save"
            (click)="addData(data, 'false')"
            class="p-button-success mr-4 text-xl"
        ></button>
        <button
            type="button"
            pButton
            label="Cancel"
            (click)="cancelDialog()"
            class="p-button-danger text-xl"
        ></button>
    </div>
</p-dialog>

<p-dialog
    [(visible)]="editRecordDialog"
    [style]="{ width: '850px' }"
    header="Edit Records"
    [modal]="true"
    styleClass="p-fluid"
>
    <h5>Docfile RMS</h5>
    <div class="p-fluid p-formgrid grid">
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_no" class="text-xl">No</label>
            <input
                pInputText
                id="doc_no"
                type="text"
                disabled="true"
                [(ngModel)]="editData.doc_no"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_type" class="text-xl">Type</label>
            <input
                pInputText
                id="doc_type"
                type="text"
                [(ngModel)]="editData.doc_type"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_location" class="text-xl">Location</label>
            <input
                pInputText
                id="doc_location"
                type="text"
                [(ngModel)]="editData.doc_location"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_status" class="text-xl">Status</label>
            <input
                pInputText
                id="doc_status"
                type="text"
                [(ngModel)]="editData.doc_status"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_category" class="text-xl">Category</label>
            <input
                pInputText
                id="doc_category"
                type="text"
                [(ngModel)]="editData.doc_category"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_aircrafte" class="text-xl">Aircrafte</label>
            <input
                pInputText
                id="doc_aircrafte"
                type="text"
                [(ngModel)]="editData.doc_aircrafte"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_work_packagee" class="text-xl"
                >Work Package</label
            >
            <input
                pInputText
                id="doc_work_packagee"
                type="text"
                [(ngModel)]="editData.doc_work_packagee"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_reason" class="text-xl">Reason</label>
            <input
                pInputText
                id="doc_reason"
                type="text"
                [(ngModel)]="editData.doc_reason"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_returndate" class="text-xl">Return Date</label>
            <input
                pInputText
                id="doc_returndate"
                type="text"
                [(ngModel)]="editData.doc_returndate"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_retention_schedule" class="text-xl"
                >Retention Schedule</label
            >
            <input
                pInputText
                id="doc_retention_schedule"
                type="text"
                [(ngModel)]="editData.doc_retention_schedule"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_last_received" class="text-xl"
                >Last Received</label
            >
            <input
                pInputText
                id="doc_last_received"
                type="text"
                [(ngModel)]="editData.doc_last_received"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_last_rejected" class="text-xl"
                >Last Rejected</label
            >
            <input
                pInputText
                id="doc_last_rejected"
                type="text"
                [(ngModel)]="editData.doc_last_rejected"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_filed" class="text-xl">Document Filled</label>
            <input
                pInputText
                id="doc_filed"
                type="text"
                [(ngModel)]="editData.doc_filed"
            />
        </div>
    </div>

    <div class="p-dialog-footer">
        <button
            type="button"
            pButton
            label="Save"
            (click)="addData(data, 'true')"
            class="p-button-success mr-4 text-xl"
        ></button>
        <button
            type="button"
            pButton
            label="Cancel"
            (click)="cancelDialog()"
            class="p-button-danger text-xl"
        ></button>
    </div>
</p-dialog>

<p-dialog
    [(visible)]="exportDialog"
    [style]="{ width: '400px', height: '250px' }"
    header="Pilihan Export File"
    [modal]="true"
    styleClass="p-fluid"
>
    <div class="p-field">
        <label for="exportFormat" class="mb-2">Pilih Format Export:</label>
        <div class="mt-2">
            <p-dropdown
                id="exportFormat"
                [(ngModel)]="selectedExportFormat"
                [options]="exportFormats"
                class="mt-2"
            ></p-dropdown>
        </div>
    </div>
    <div class="p-dialog-footer mt-4">
        <button
            pButton
            type="button"
            label="Export"
            (click)="exportData()"
            class="p-button-success mr-2 text-align-center"
        ></button>
        <button
            pButton
            type="button"
            label="Cancel"
            (click)="cancelDialog()"
            class="ml-2 p-button-danger text-align-center"
        ></button>
    </div>
</p-dialog>

<p-confirmDialog
    [style]="{ width: '450px' }"
    rejectButtonStyleClass="p-button-danger"
    acceptButtonStyleClass="p-button-success"
></p-confirmDialog>
