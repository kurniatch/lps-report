<div class="grid mb-4">
    <div class="col-12 lg:col-6 xl:col-3" *ngFor="let variable of [1, 2, 3, 4]; let i = index">
        <div class="card mb-0">
            <div class="flex justify-content-between mb-3">
                <div>
                    <span class="block text-500 font-medium mb-3 text-xl">
                        Variabel {{ variable }}
                        <i class="text-900 pi pi-pencil" style="cursor: pointer; margin-left: 5px;"></i>
                    </span>
                    <div class="text-900 font-medium text-xl">
                        <input pInputText type="number" [(ngModel)]="this['variabel' + variable]"
                            (ngModelChange)="onVariableChange()" />
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="card col-12 ">
        <h5 class="font-medium mb-3 ml-4 text-xl">Select Bank
            <span class="ml-4">
                <p-dropdown [options]="dataBank" [(ngModel)]="selectedSearch" optionLabel="label" optionValue="value"
                    class="text-2xl" [filter]="true" placeholder="Select Bank" [showClear]="true">
                </p-dropdown>
                <button pButton pRipple icon="pi pi-plus" class="p-button-success ml-8" (click)="openNew()"
                    aria-label="Tambah" [disabled]="!selectedSearch">
                </button>
            </span>
        </h5>
        <p-table [value]="modifiedDataTable" dataKey="id" [tableStyle]="{ 'min-width': '50rem' }">
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="pos" style="width:25%">
                        Pos - Pos <p-sortIcon field="pos" />
                    </th>
                    <th pSortableColumn="nominal_rupiah" style="width:20%">
                        Nominal Rupiah <p-sortIcon field="nominal_rupiah" />
                        <i class="ml-4 pi pi-pencil" style="cursor:pointer; margin-left:5px;"></i>
                    </th>
                    <th pSortableColumn="nominal_valas" style="width:20%">
                        Nominal Valas <p-sortIcon field="nominal_valas" />
                        <i class="ml-4 pi pi-pencil" style="cursor:pointer; margin-left:5px;"></i>
                    </th>
                    <th pSortableColumn="nominal_total" style="width:20%">
                        Nominal Total <p-sortIcon field="nominal_total" />
                        <i class="ml-4 pi pi-pencil" style="cursor:pointer; margin-left:5px;"></i>
                    </th>
                    <th pSortableColumn="hasil" style="width:20%">
                        Hasil <p-sortIcon field="hasil" />
                    </th>
                </tr>

                <tr>
                    <th>
                        <p-columnFilter type="text" field="pos" [showClearButton]="false" />
                    </th>
                    <th>
                        <p-columnFilter type="text" field="nominal_rupiah" [showClearButton]="false" />
                    </th>
                    <th>
                        <p-columnFilter type="text" field="nominal_valas" [showClearButton]="false" />
                    </th>
                    <th>
                        <p-columnFilter type="text" field="nominal_total" [showClearButton]="false" />
                    </th>
                    <th>
                        <p-columnFilter type="text" field="hasil" [showClearButton]="false" />
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-product>
                <tr>
                    <td>
                        {{ product.pos}}
                    </td>

                    <td [pEditableColumn]="product.nominal_rupiah" pEditableColumnField="nominal_rupiah">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <input pInputText type="text" [(ngModel)]="product.nominal_rupiah" required />
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{ product.nominal_rupiah | number:'1.0-0':'id' }}
                            </ng-template>
                        </p-cellEditor>
                    </td>

                    <td [pEditableColumn]="product.nominal_valas" pEditableColumnField="nominal_valas">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <input pInputText type="text" [(ngModel)]="product.nominal_valas" />
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{ product.nominal_valas | number:'1.0-0':'id' }}
                            </ng-template>
                        </p-cellEditor>
                    </td>

                    <td [pEditableColumn]="product.nominal_total" pEditableColumnField="nominal_valas_total">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <input pInputText type="text" [(ngModel)]="product.nominal_total" />
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{ product.nominal_total | number:'1.0-0':'id' }}
                            </ng-template>
                        </p-cellEditor>
                    </td>

                    <td>
                        <i *ngIf="product.hasil === 'Setuju'" class="pi pi-check-circle text-green-500 mr-2"></i>
                        <i *ngIf="product.hasil === 'Tinjau Ulang'"
                            class="pi pi-exclamation-circle text-yellow-500 mr-2"></i>
                        <i *ngIf="product.hasil === 'Tolak'" class="pi pi-times-circle text-red-500 mr-2"></i>
                        {{ product.hasil }}
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>


</div>

<p-dialog [(visible)]="recordDialog" [style]="{ width: '850px' }" header="Added Pos" [modal]="true" styleClass="p-fluid"
    class="grid grid-cols-2 gap-4">
    <h5>Masukkan data untuk Analyst</h5>
    <div class="p-fluid p-formgrid grid">
        <div class="field col-12 md:col-6">
            <label for="doc_no" class="text-xl mb-2 block">Jenis Laporan</label>
            <p-dropdown [options]="database" [(ngModel)]="selectedBase" optionLabel="label" opti onValue="value"
                placeholder="Pilih Laporan" [showClear]="true" class="w-full" [filter]="true"
                (onChange)="buttonLct($event)">
            </p-dropdown>
        </div>
        <div class="field col-12 md:col-6">
            <label for="doc_no" class="text-xl mb-2 block">Pilih Pos</label>
            <p-dropdown [options]="reportDataLct" [(ngModel)]="selectedPos" optionLabel="label" optionValue="value"
                placeholder="Pilih Pos" [showClear]="true" class="w-full" [filter]="true" [disabled]="!selectedBase"
                (onChange)="onPosChange()">
            </p-dropdown>
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="nominal_rupiah" class="text-xl">Nominal Rupiah</label>
            <input pInputText id="nominal_rupiah" type="text"
                [value]="selectedDataPop?.total_nominal_rupiah | number:'1.0-0':'id'" [disabled]="true" />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="nominal_valas" class="text-xl">Nominal Valas</label>
            <input pInputText id="nominal_valas" type="text"
                [value]="selectedDataPop?.total_nominal_valas | number:'1.0-0':'id'" [disabled]="true" />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="nominal_total" class="text-xl">Nominal Total</label>
            <input pInputText id="nominal_total" type="text"
                [value]="selectedDataPop?.total_nominal_total | number:'1.0-0':'id'" [disabled]="true" />
        </div>
    </div>

    <div class="p-dialog-footer">
        <button type="button" pButton label="Save" (click)="addData()" class="p-button-success mr-4 text-xl"></button>
        <button type="button" pButton label="Cancel" (click)="cancelDialog()" class="p-button-danger text-xl"></button>
    </div>
</p-dialog>

<p-dialog [(visible)]="exportDialog" [style]="{ width: '400px', height: '250px' }" header="Pilihan Export File"
    [modal]="true" styleClass="p-fluid">
    <div class="p-field">
        <label for="exportFormat" class="mb-2">Pilih Format Export:</label>
        <div class="mt-2">
            <p-dropdown id="exportFormat" [(ngModel)]="selectedExportFormat" [options]="exportFormats"
                class="mt-2"></p-dropdown>
        </div>
    </div>
    <div class="p-dialog-footer mt-4">
        <button pButton type="button" label="Export" (click)="exportData()"
            class="p-button-success mr-2 text-align-center"></button>
        <button pButton type="button" label="Cancel" (click)="cancelDialog()"
            class="ml-2 p-button-danger text-align-center"></button>
    </div>
</p-dialog>

<p-confirmDialog [style]="{ width: '450px' }" rejectButtonStyleClass="p-button-danger"
    acceptButtonStyleClass="p-button-success"></p-confirmDialog>