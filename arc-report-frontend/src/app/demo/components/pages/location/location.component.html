<div class="grid">
    <div class="col-12">
        <p-toast></p-toast>
        <p-toolbar styleClass="mb-4 gap-2">
            <ng-template pTemplate="left">
                <button
                    pButton
                    pRipple
                    icon="pi pi-plus"
                    class="p-button-success mr-2"
                    (click)="openNew()"
                ></button>
                <button
                    pButton
                    pRipple
                    icon="pi pi-trash"
                    class="p-button-danger"
                    [disabled]="!selectedProducts || !selectedProducts.length"
                ></button>
                <button
                    pButton
                    pRipple
                    label="Export"
                    icon="pi pi-upload"
                    class="p-button-help ml-8"
                    (click)="openExport()"
                ></button>
                <p-fileUpload
                    mode="basic"
                    accept="image/*"
                    [maxFileSize]="1000000"
                    label="Import"
                    chooseLabel="Import"
                    class="ml-4 inline-block"
                ></p-fileUpload>
            </ng-template>
        </p-toolbar>
        <div class="card">
            <h5>Locations RMS Report</h5>
            <p-table
                #dt1
                [columns]="components1"
                [value]="components1"
                [lazy]="true"
                (onLazyLoad)="onLazyLoad($event)"
                [loading]="loading"
                [paginator]="!findSearch"
                [rows]="10"
                [totalRecords]="totalRecords"
                dataKey="id"
                [rowHover]="true"
                styleClass="p-datatable-gridlines"
                responsiveLayout="scroll"
            >
                <ng-template pTemplate="caption">
                    <div
                        class="flex justify-content-between flex-column sm:flex-row"
                    >
                        <button
                            pButton
                            label="Clear"
                            class="p-button-outlined mb-2"
                            icon="pi pi-filter-slash"
                            (click)="clear(dt1)"
                        ></button>
                        <span class="p-input-icon-left mb-2">
                            <span class="p-input-icon-left mr-4">
                                <i class="pi pi-search"></i>
                                <input
                                    label="inputSearch"
                                    type="text"
                                    pInputText
                                    [(ngModel)]="findSearch"
                                    (keydown.enter)="findData(findSearch)"
                                />
                            </span>
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Doc Box
                                <p-sortIcon
                                    field="material_number"
                                ></p-sortIcon>
                            </div>
                        </th>
                        <th style="min-width: 8rem">
                            <div
                                class="flex justify-content-between align-items-center"
                            >
                                Doc Locations
                                <p-sortIcon field="serial_number"></p-sortIcon>
                            </div>
                        </th>
                        <th class="text-center" style="min-width: 10rem">
                            Actions
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-customer>
                    <tr>
                        <td class="text-center">
                            {{ customer?.doc_box }}
                        </td>
                        <td class="text-center">
                            {{ customer?.doc_locations }}
                        </td>
                        <td class="text-center">
                            <button
                                pButton
                                pRipple
                                icon="pi pi-pencil"
                                class="p-button-rounded p-button-success mr-2"
                                (click)="editProduct(customer)"
                            ></button>
                            <button
                                pButton
                                pRipple
                                icon="pi pi-trash"
                                class="p-button-rounded p-button-warning"
                                (click)="deleteProduct(customer)"
                            ></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8">No component found.</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td colspan="8">
                            Loading components data. Please wait.
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        <p-toast></p-toast>
    </div>
</div>

<p-dialog
    [(visible)]="recordDialog"
    [style]="{ width: '850px' }"
    header="New Records"
    [modal]="true"
    styleClass="p-fluid"
    class="grid grid-cols-2 gap-4"
>
    <h5>Location RMS</h5>
    <div class="p-fluid p-formgrid grid">
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_no" class="text-xl">Doc Box</label>
            <input
                pInputText
                id="doc_box"
                type="text"
                [(ngModel)]="data.location.doc_box"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_type" class="text-xl">Doc Locations</label>
            <input
                pInputText
                id="doc_locations"
                type="text"
                [(ngModel)]="data.location.doc_locations"
            />
        </div>
    </div>

    <div class="p-dialog-footer">
        <button
            type="button"
            pButton
            label="Save"
            (click)="addData(data, 'false')"
            class="p-button-success mr-4 text-xl"
        ></button>
        <button
            type="button"
            pButton
            label="Cancel"
            (click)="cancelDialog()"
            class="p-button-danger text-xl"
        ></button>
    </div>
</p-dialog>

<p-dialog
    [(visible)]="editRecordDialog"
    [style]="{ width: '850px' }"
    header="Edit Records"
    [modal]="true"
    styleClass="p-fluid"
>
    <h5>Location RMS</h5>
    <div class="p-fluid p-formgrid grid">
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_no" class="text-xl">Doc Box</label>
            <input
                pInputText
                id="doc_no"
                type="text"
                disabled="true"
                [(ngModel)]="editData.doc_box"
            />
        </div>
        <div class="field col-12 md:col-6">
            <label htmlFor="doc_type" class="text-xl">Doc Locations</label>
            <input
                pInputText
                id="doc_type"
                type="text"
                [(ngModel)]="editData.doc_locations"
            />
        </div>
    </div>

    <div class="p-dialog-footer">
        <button
            type="button"
            pButton
            label="Save"
            (click)="addData(data, 'true')"
            class="p-button-success mr-4 text-xl"
        ></button>
        <button
            type="button"
            pButton
            label="Cancel"
            (click)="cancelDialog()"
            class="p-button-danger text-xl"
        ></button>
    </div>
</p-dialog>

<p-dialog
    [(visible)]="exportDialog"
    [style]="{ width: '400px', height: '250px' }"
    header="Pilihan Export File"
    [modal]="true"
    styleClass="p-fluid"
>
    <div class="p-field">
        <label for="exportFormat" class="mb-2">Pilih Format Export:</label>
        <div class="mt-2">
            <p-dropdown
                id="exportFormat"
                [(ngModel)]="selectedExportFormat"
                [options]="exportFormats"
                class="mt-2"
            ></p-dropdown>
        </div>
    </div>
    <div class="p-dialog-footer mt-4">
        <button
            pButton
            type="button"
            label="Export"
            (click)="exportData()"
            class="p-button-success mr-2 text-align-center"
        ></button>
        <button
            pButton
            type="button"
            label="Cancel"
            (click)="cancelDialog()"
            class="ml-2 p-button-danger text-align-center"
        ></button>
    </div>
</p-dialog>

<p-confirmDialog
    [style]="{ width: '450px' }"
    rejectButtonStyleClass="p-button-danger"
    acceptButtonStyleClass="p-button-success"
></p-confirmDialog>
